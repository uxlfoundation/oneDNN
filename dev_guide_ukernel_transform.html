

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data transformation &#8212; oneDNN v3.11.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/doxyrest_code_copy_button.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script src="_static/target-highlight.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'dev_guide_ukernel_transform';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '/oneDNN/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v3.11';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="_static/favicons.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="BRGeMM ukernel example" href="page_cpu_brgemm_example_cpp.html" />
    <link rel="prev" title="Batch-Reduce General Matrix Multiplication" href="dev_guide_ukernel_brgemm.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/oneAPI-rgb-rev-100.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/oneAPI-rgb-rev-100.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">oneDNN v3.11 Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dev_guide_system_requirements.html">System Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_guide_build.html">Build from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_guide_build_options.html">Use Build Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev_guide_link.html">Link to the Library</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Learn oneDNN</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dev_guide_basic_concepts.html">Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_getting_started_cpp.html">Functional API Basic Workflow</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="programming_model.html">oneDNN Concepts</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="page_memory_format_propagation_cpp.html">Memory Format Propagation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="dev_guide_inference_and_training_aspects.html">Inference and Training Aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_inference.html">Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_inference_int8.html">Int8 Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_training_bf16.html">Bfloat16 Training</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="dev_guide_attributes.html">Primitive Attributes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_attributes_fpmath_mode.html">Floating-point Math Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_attributes_accumulation_mode.html">Accumulation Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_attributes_rounding_mode.html">Rounding Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_attributes_deterministic.html">Deterministic Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_attributes_dropout.html">Dropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_attributes_quantization.html">Quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_attributes_post_ops.html">Post-ops</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_attributes_scratchpad.html">Scratchpad</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_data_types.html">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_cross_engine_reorder_cpp.html">Reorder between CPU and GPU engines</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_c_and_cpp_apis.html">API</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="interop_with_dpcpp_and_opencl.html">Interoperability with DPC++ and OpenCL</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_opencl_interoperability.html">OpenCL Interoperability</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_dpcpp_interoperability.html">DPC++ Interoperability</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="supported_primitives.html">Supported Primitives</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_convolution.html">Convolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_inner_product.html">Inner Product</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_matmul.html">Matrix Multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_rnn.html">RNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_batch_normalization.html">Batch Normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_binary.html">Binary</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_concat.html">Concat</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_eltwise.html">Eltwise</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_group_normalization.html">Group Normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_layer_normalization.html">Layer Normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_lrn.html">Local Response Normalization (LRN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_pooling.html">Pooling</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_prelu.html">PReLU</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_resampling.html">Resampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_shuffle.html">Shuffle</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_softmax.html">Softmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_sum.html">Sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_reorder.html">Reorder</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_reduction.html">Reduction</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="graph_extension.html">Graph Extension</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="graph_programming_model.html">Programming Model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_basic_concepts.html">Basic Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_low_precision.html">Low Precision</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="graph_supported_operations.html">Supported Operations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_abs.html">Abs</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_absbackward.html">AbsBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_add.html">Add</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_avgpool.html">AvgPool</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_avgpoolbackward.html">AvgPoolBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_batchnormforwardtraining.html">BatchNormForwardTraining</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_batchnorminference.html">BatchNormInference</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_batchnormtrainingbackward.html">BatchNormTrainingBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_biasadd.html">BiasAdd</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_biasaddbackward.html">BiasAddBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_clamp.html">Clamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_clampbackward.html">ClampBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_concat.html">Concat</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_convolution.html">Convolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_convolutionbackwarddata.html">ConvolutionBackwardData</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_convolutionbackwardweights.html">ConvolutionBackwardWeights</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_convtranspose.html">ConvTranspose</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_convtransposebackwarddata.html">ConvTransposeBackwardData</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_convtransposebackwardweights.html">ConvTransposeBackwardWeights</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_dequantize.html">Dequantize</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_divide.html">Divide</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_dynamicdequantize.html">DynamicDequantize</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_dynamicquantize.html">DynamicQuantize</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_elu.html">Elu</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_elubackward.html">EluBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_end.html">End</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_exp.html">Exp</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_gelu.html">GELU</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_gelubackward.html">GELUBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_genindex.html">GenIndex</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_greaterequal.html">GreaterEqual</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_groupnorm.html">GroupNorm</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_hardsigmoid.html">HardSigmoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_hardsigmoidbackward.html">HardSigmoidBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_hardswish.html">HardSwish</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_hardswishbackward.html">HardSwishBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_interpolate.html">Interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_interpolatebackward.html">InterpolateBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_layernorm.html">LayerNorm</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_layernormbackward.html">LayerNormBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_leakyrelu.html">LeakyReLU</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_log.html">Log</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_logsoftmax.html">LogSoftmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_logsoftmaxbackward.html">LogSoftmaxBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_matmul.html">MatMul</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_maximum.html">Maximum</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_maxpool.html">MaxPool</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_maxpoolbackward.html">MaxPoolBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_minimum.html">Minimum</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_mish.html">Mish</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_mishbackward.html">MishBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_multiply.html">Multiply</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_pow.html">Pow</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_prelu.html">PReLU</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_prelubackward.html">PReLUBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_quantize.html">Quantize</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_reciprocal.html">Reciprocal</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_reducel1.html">ReduceL1</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_reducel2.html">ReduceL2</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_reducemax.html">ReduceMax</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_reducemean.html">ReduceMean</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_reducemin.html">ReduceMin</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_reduceprod.html">ReduceProd</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_reducesum.html">ReduceSum</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_relu.html">ReLU</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_relubackward.html">ReLUBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_reorder.html">Reorder</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_round.html">Round</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_select.html">Select</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_sigmoid.html">Sigmoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_sigmoidbackward.html">SigmoidBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_softmax.html">SoftMax</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_softmaxbackward.html">SoftMaxBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_softplus.html">SoftPlus</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_softplusbackward.html">SoftPlusBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_sqrt.html">Sqrt</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_sqrtbackward.html">SqrtBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_square.html">Square</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_squareddifference.html">SquaredDifference</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_staticreshape.html">StaticReshape</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_statictranspose.html">StaticTranspose</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_subtract.html">Subtract</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_tanh.html">Tanh</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_tanhbackward.html">TanhBackward</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_typecast.html">TypeCast</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_op_wildcard.html">Wildcard</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="graph_fusion_patterns.html">Fusion Patterns</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_gated_mlp.html">Gated Multi-Layer Perceptron (Gated-MLP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_gqa.html">Grouped Query Attention (GQA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_sdpa_compressed_kv.html">SDPA with Compressed Key and Value</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_sdpa.html">Scaled Dot-Product Attention (SDPA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_matmul_fusion_patterns.html">MatMul</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_quantized_matmul_fusion_patterns.html">Quantized MatMul</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_convolution_fusion_patterns.html">Convolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_quantized_convolution_fusion_patterns.html">Quantized Convolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_convtranspose_fusion_patterns.html">ConvTranspose</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_quantized_convtranspose_fusion_patterns.html">Quantized ConvTranspose</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_binary_fusion_patterns.html">Binary</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_unary_fusion_patterns.html">Unary</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_interpolate_fusion_patterns.html">Interpolate</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_reduction_fusion_patterns.html">Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_pool_fusion_patterns.html">Pool</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_norm_fusion_patterns.html">Norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="dev_guide_graph_softmax_fusion_patterns.html">SoftMax</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_graph_dump.html">Graph Dump</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_constant_tensor_cache.html">Constant Tensor Cache</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="dev_guide_examples.html">Examples and Tutorials</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="performance_profiling_and_inspection.html">Performance Profiling and Inspection</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_verbose.html">Verbose Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_performance_settings.html">Configuring oneDNN for Benchmarking</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_benchdnn.html">Benchmarking Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_profilers.html">Profiling oneDNN Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_inspecting_jit.html">Inspecting JIT Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_performance_profiling_cpp.html">Performance Profiling Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_cpu_dispatcher_control.html">CPU Dispatcher Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_cpu_isa_hints.html">CPU ISA Hints</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_verbose_table.html">Verbose Message Catalogue</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="advanced_topics.html">Advanced Topics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_transition_to_dnnl.html">Transitioning from Intel MKL-DNN to oneDNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_understanding_memory_formats.html">Understanding Memory Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_int8_computations.html">Nuances of int8 Computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_primitive_cache.html">Primitive Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_persistent_cache.html">Persistent Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_threadpool.html">Using oneDNN with Threadpool-Based Threading</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_sparsity.html">Sparse memory formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_host_side_scalars.html">Host-Side Scalars Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_experimental.html">Experimental features</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="ukernels.html">Ukernels</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dev_guide_ukernel_basic_concepts.html">Basic Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="dev_guide_ukernel_brgemm.html">Batch-Reduce General Matrix Multiplication</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Data transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_cpu_brgemm_example_cpp.html">BRGeMM ukernel example</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Developer Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="group_dnnl_api.html">oneDNN API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="group_dnnl_api_primitives.html">Primitives</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_primitives_common.html">Common</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_alg_kind_t.html">enum dnnl_alg_kind_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_normalization_flags_t.html">enum dnnl_normalization_flags_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_primitive_kind_t.html">enum dnnl_primitive_kind_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_prop_kind_t.html">enum dnnl_prop_kind_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_query_t.html">enum dnnl_query_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_normalization_flags.html">enum dnnl::normalization_flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_query.html">enum dnnl::query</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_exec_arg_t.html">struct dnnl_exec_arg_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_primitive.html">struct dnnl_primitive</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_primitive_desc.html">struct dnnl_primitive_desc</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_primitive-2.html">struct dnnl::primitive</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_primitive_desc-2.html">struct dnnl::primitive_desc</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_primitive_desc_base.html">struct dnnl::primitive_desc_base</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_attributes.html">Attributes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_algorithm.html">enum dnnl::algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_quantization_mode_t.html">enum dnnl_quantization_mode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_rounding_mode_t.html">enum dnnl_rounding_mode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_scratchpad_mode_t.html">enum dnnl_scratchpad_mode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_prop_kind.html">enum dnnl::prop_kind</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_quantization_mode.html">enum dnnl::quantization_mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_rounding_mode.html">enum dnnl::rounding_mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_scratchpad_mode.html">enum dnnl::scratchpad_mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_post_ops.html">struct dnnl_post_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_primitive_attr.html">struct dnnl_primitive_attr</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_post_ops-2.html">struct dnnl::post_ops</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_primitive_attr-2.html">struct dnnl::primitive_attr</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_reorder.html">Reorder</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_reorder.html">struct dnnl::reorder</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_concat.html">Concat</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_concat.html">struct dnnl::concat</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_sum.html">Sum</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_sum.html">struct dnnl::sum</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_binary.html">Binary</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_binary.html">struct dnnl::binary</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_convolution.html">Convolution</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_convolution_backward_data.html">struct dnnl::convolution_backward_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_convolution_backward_weights.html">struct dnnl::convolution_backward_weights</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_convolution_forward.html">struct dnnl::convolution_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_deconvolution.html">Deconvolution</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_deconvolution_backward_data.html">struct dnnl::deconvolution_backward_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_deconvolution_backward_weights.html">struct dnnl::deconvolution_backward_weights</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_deconvolution_forward.html">struct dnnl::deconvolution_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_shuffle.html">Shuffle</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_shuffle_backward.html">struct dnnl::shuffle_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_shuffle_forward.html">struct dnnl::shuffle_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_eltwise.html">Eltwise</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_eltwise_backward.html">struct dnnl::eltwise_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_eltwise_forward.html">struct dnnl::eltwise_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_softmax.html">Softmax</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_softmax_backward.html">struct dnnl::softmax_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_softmax_forward.html">struct dnnl::softmax_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_pooling.html">Pooling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_pooling_backward.html">struct dnnl::pooling_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_pooling_forward.html">struct dnnl::pooling_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_prelu.html">PReLU</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_prelu_backward.html">struct dnnl::prelu_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_prelu_forward.html">struct dnnl::prelu_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_lrn.html">LRN</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_lrn_backward.html">struct dnnl::lrn_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_lrn_forward.html">struct dnnl::lrn_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_batch_normalization.html">Batch Normalization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_batch_normalization_backward.html">struct dnnl::batch_normalization_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_batch_normalization_forward.html">struct dnnl::batch_normalization_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_group_normalization.html">Group Normalization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_group_normalization_backward.html">struct dnnl::group_normalization_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_group_normalization_forward.html">struct dnnl::group_normalization_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_layer_normalization.html">Layer Normalization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_layer_normalization_backward.html">struct dnnl::layer_normalization_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_layer_normalization_forward.html">struct dnnl::layer_normalization_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_inner_product.html">Inner Product</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_inner_product_backward_data.html">struct dnnl::inner_product_backward_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_inner_product_backward_weights.html">struct dnnl::inner_product_backward_weights</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_inner_product_forward.html">struct dnnl::inner_product_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_rnn.html">RNN</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_rnn_direction_t.html">enum dnnl_rnn_direction_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_rnn_flags_t.html">enum dnnl_rnn_flags_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_rnn_direction.html">enum dnnl::rnn_direction</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_rnn_flags.html">enum dnnl::rnn_flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_augru_backward.html">struct dnnl::augru_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_augru_forward.html">struct dnnl::augru_forward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_gru_backward.html">struct dnnl::gru_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_gru_forward.html">struct dnnl::gru_forward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_lbr_augru_backward.html">struct dnnl::lbr_augru_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_lbr_augru_forward.html">struct dnnl::lbr_augru_forward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_lbr_gru_backward.html">struct dnnl::lbr_gru_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_lbr_gru_forward.html">struct dnnl::lbr_gru_forward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_lstm_backward.html">struct dnnl::lstm_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_lstm_forward.html">struct dnnl::lstm_forward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_rnn_primitive_desc_base.html">struct dnnl::rnn_primitive_desc_base</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_vanilla_rnn_backward.html">struct dnnl::vanilla_rnn_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_vanilla_rnn_forward.html">struct dnnl::vanilla_rnn_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_matmul.html">Matrix Multiplication</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_matmul.html">struct dnnl::matmul</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_resampling.html">Resampling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_resampling_backward.html">struct dnnl::resampling_backward</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_resampling_forward.html">struct dnnl::resampling_forward</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_reduction.html">Reduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_reduction.html">struct dnnl::reduction</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="group_dnnl_api_primitive_cache.html">Primitive Cache</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="group_dnnl_api_profiling.html">Profiling</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="enum_dnnl_profiling_data_kind.html">enum dnnl::profiling_data_kind</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="group_dnnl_api_blas.html">BLAS functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="group_dnnl_api_common.html">Common API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_engine.html">Engine</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_engine_kind_t.html">enum dnnl_engine_kind_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_engine.html">struct dnnl_engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_engine-2.html">struct dnnl::engine</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_stream.html">Stream</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_stream_flags_t.html">enum dnnl_stream_flags_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_stream.html">struct dnnl_stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_stream-2.html">struct dnnl::stream</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_fpmath_mode.html">Floating-point Math Mode</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_fpmath_mode_t.html">enum dnnl_fpmath_mode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_fpmath_mode.html">enum dnnl::fpmath_mode</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_service.html">Service</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_cpu_isa.html">enum dnnl::cpu_isa</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_cpu_isa_hints.html">enum dnnl::cpu_isa_hints</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_cpu_isa_hints_t.html">enum dnnl_cpu_isa_hints_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_cpu_isa_t.html">enum dnnl_cpu_isa_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_status.html">enum dnnl::status</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_version_t.html">struct dnnl_version_t</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_utils.html">Utilities</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_status_t.html">enum dnnl_status_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_error.html">struct dnnl::error</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_handle.html">template struct dnnl::handle</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_handle_traits.html">template struct dnnl::handle_traits</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_accumulation_mode.html">Accumulation Mode</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_accumulation_mode.html">enum dnnl::accumulation_mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_accumulation_mode_t.html">enum dnnl_accumulation_mode_t</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_data_types.html">Data types</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_data_type_t.html">enum dnnl_data_type_t</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_memory.html">Memory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_format_kind_t.html">enum dnnl_format_kind_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_format_tag_t.html">enum dnnl_format_tag_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_profiling_data_kind_t.html">enum dnnl_profiling_data_kind_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_sparse_encoding_t.html">enum dnnl_sparse_encoding_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_memory.html">struct dnnl_memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_memory_desc.html">struct dnnl_memory_desc</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_memory-2.html">struct dnnl::memory</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="group_dnnl_graph_api.html">Graph API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_allocator.html">Allocator</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="class_dnnl_graph_allocator.html">class dnnl::graph::allocator</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_engine.html">Engine</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_logical_tensor.html">Logical Tensor</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_graph_layout_type_t.html">enum dnnl_graph_layout_type_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_graph_tensor_property_t.html">enum dnnl_graph_tensor_property_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_graph_logical_tensor_t.html">struct dnnl_graph_logical_tensor_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="class_dnnl_graph_logical_tensor.html">class dnnl::graph::logical_tensor</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_tensor.html">Tensor</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="class_dnnl_graph_tensor.html">class dnnl::graph::tensor</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_op.html">Op</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_graph_op_attr_t.html">enum dnnl_graph_op_attr_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_graph_op_kind_t.html">enum dnnl_graph_op_kind_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="class_dnnl_graph_op.html">class dnnl::graph::op</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_partition.html">Partition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_graph_partition_policy_t.html">enum dnnl_graph_partition_policy_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="class_dnnl_graph_partition.html">class dnnl::graph::partition</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_compiled_partition.html">Compiled Partition</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_graph_inplace_pair_t.html">struct dnnl_graph_inplace_pair_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="class_dnnl_graph_compiled_partition.html">class dnnl::graph::compiled_partition</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_graph.html">Graph</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_graph_dump_mode_t.html">enum dnnl_graph_dump_mode_t</a></li>
<li class="toctree-l4"><a class="reference internal" href="class_dnnl_graph_graph.html">class dnnl::graph::graph</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_compiled_partition_cache.html">Compiled Partition Cache</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_constant_tensor_cache.html">Constant Tensor Cache</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_dump_mode.html">Dump Mode</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_graph_graph_dump_mode.html">enum dnnl::graph::graph_dump_mode</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_utils.html">Utilities</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_status.html">Status</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_graph_status.html">enum dnnl::graph::status</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_graph_api_interop.html">Runtime interoperability API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="group_dnnl_graph_api_ocl_interop.html">OpenCL interoperability API</a></li>
<li class="toctree-l4"><a class="reference internal" href="group_dnnl_graph_api_sycl_interop.html">SYCL interoperability API</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="namespace_dnnl_graph.html">namespace dnnl::graph</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="group_dnnl_api_interop.html">Runtime interoperability API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_ocl_interop.html">OpenCL interoperability API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="namespace_dnnl_ocl_interop.html">namespace dnnl::ocl_interop</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_ocl_interop_memory_kind_t.html">enum dnnl_ocl_interop_memory_kind_t</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_sycl_interop.html">SYCL interoperability API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="namespace_dnnl_sycl_interop.html">namespace dnnl::sycl_interop</a></li>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_sycl_interop_memory_kind_t.html">enum dnnl_sycl_interop_memory_kind_t</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_threadpool_interop.html">Threadpool interoperability API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="namespace_dnnl_threadpool_interop.html">namespace dnnl::threadpool_interop</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="group_dnnl_api_ukernel.html">Ukernels</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_ukernel_brgemm.html">BRGeMM ukernel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html">struct dnnl::ukernel::brgemm</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_brgemm.html">struct dnnl_brgemm</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_ukernel_transform.html">Transform ukernel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_transform.html">struct dnnl_transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_ukernel_transform.html">struct dnnl::ukernel::transform</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="group_dnnl_api_ukernel_utils.html">ukernel utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="enum_dnnl_ukernel_pack_type.html">enum dnnl::ukernel::pack_type</a></li>
<li class="toctree-l4"><a class="reference internal" href="struct_dnnl_ukernel_attr_params-2.html">struct dnnl::ukernel::attr_params</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="namespace_dnnl_ukernel.html">namespace dnnl::ukernel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="enum_dnnl_pack_type_t.html">enum dnnl_pack_type_t</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="struct_dnnl_ukernel_attr_params.html">struct dnnl_ukernel_attr_params</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="namespace_dnnl.html">namespace dnnl</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="namespace_oneapi.html">namespace oneapi</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
        <div class="header-article-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/uxlfoundation/oneDNN" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/uxlfoundation/oneDNN/issues/new?title=Issue%20on%20page%20%2Fdev_guide_ukernel_transform.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/dev_guide_ukernel_transform.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data transformation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general">General</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-types">Data Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-representation">Data Representation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-limitations">Implementation limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="data-transformation">
<span id="doxid-dev-guide-ukernel-transform"></span><span id="index-0"></span><h1>Data transformation<a class="headerlink" href="#data-transformation" title="Permalink to this heading">#</a></h1>
<p><a class="reference internal" href="struct_dnnl_ukernel_transform.html#doxid-structdnnl-1-1ukernel-1-1transform"><span class="std std-ref">API Reference</span></a></p>
<section id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference internal" href="dev_guide_ukernel_brgemm.html#doxid-dev-guide-ukernel-brgemm"><span class="std std-ref">BRGeMM ukernel</span></a> might require the B tensor in a specific memory layout depending on target data types and the machine architecture. Check the requirement by calling the <a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1aa2e3310da8dd905e3f7ee81060f1ad19"><span class="std std-ref">get_B_pack_type()</span></a> function. The return value specifies one of the following scenarios:</p>
<ul class="simple">
<li><p>If the call returns the <a class="reference internal" href="enum_dnnl_ukernel_pack_type.html#doxid-group-dnnl-api-ukernel-utils-1gga241c23d0afdf43a79d51ef701a9f7c54af31ee5e3824f1f5e5d206bdf3029f22b"><span class="std std-ref">undef</span></a> type, it indicates ukernel API is not supported on the target system.</p></li>
<li><p>If the call returns the <a class="reference internal" href="enum_dnnl_ukernel_pack_type.html#doxid-group-dnnl-api-ukernel-utils-1gga241c23d0afdf43a79d51ef701a9f7c54a76659c0424cb9f2555bc14e7d947db13"><span class="std std-ref">no_trans</span></a> type, it indicates the packing is not required.</p></li>
<li><p>Depending on the backend and packing requirements, the value indicating these requirements can be different. For x64 backend the call returns the <a class="reference internal" href="enum_dnnl_ukernel_pack_type.html#doxid-group-dnnl-api-ukernel-utils-1gga241c23d0afdf43a79d51ef701a9f7c54a120dce00fbef2144bdd023da3aecaa6b"><span class="std std-ref">pack32</span></a> type.</p></li>
</ul>
<p>The transform ukernel allows the conversion of data from the original layout, which is described as either <a class="reference internal" href="enum_dnnl_ukernel_pack_type.html#doxid-group-dnnl-api-ukernel-utils-1gga241c23d0afdf43a79d51ef701a9f7c54a76659c0424cb9f2555bc14e7d947db13"><span class="std std-ref">non-transposed</span></a> or <a class="reference internal" href="enum_dnnl_ukernel_pack_type.html#doxid-group-dnnl-api-ukernel-utils-1gga241c23d0afdf43a79d51ef701a9f7c54a4738019ef434f24099319565cd5185e5"><span class="std std-ref">transposed</span></a> to the layout requested by the BRGeMM ukernel.</p>
<p>The only supported output packing type is <code class="docutils literal notranslate"><span class="pre">pack32</span></code>.</p>
<p>This is an out-of-place operation.</p>
</section>
<section id="data-types">
<h2>Data Types<a class="headerlink" href="#data-types" title="Permalink to this heading">#</a></h2>
<p>The transform ukernel does not allow data type conversion.</p>
</section>
<section id="data-representation">
<h2>Data Representation<a class="headerlink" href="#data-representation" title="Permalink to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>src</p></th>
<th class="head"><p>dst</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>f32</p></td>
<td><p>f32</p></td>
</tr>
<tr class="row-odd"><td><p>f16</p></td>
<td><p>f16</p></td>
</tr>
<tr class="row-even"><td><p>bf16</p></td>
<td><p>bf16</p></td>
</tr>
<tr class="row-odd"><td><p>f8_e4m3</p></td>
<td><p>f8_e4m3</p></td>
</tr>
<tr class="row-even"><td><p>f8_e5m2</p></td>
<td><p>f8_e5m2</p></td>
</tr>
<tr class="row-odd"><td><p>s8</p></td>
<td><p>s8</p></td>
</tr>
<tr class="row-even"><td><p>u8</p></td>
<td><p>u8</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Permalink to this heading">#</a></h2>
<p>No attribute is supported for transform ukernel.</p>
</section>
<section id="implementation-limitations">
<h2>Implementation limitations<a class="headerlink" href="#implementation-limitations" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Destination leading dimension, or <code class="docutils literal notranslate"><span class="pre">out_ld</span></code>, must be one of the following values: <code class="docutils literal notranslate"><span class="pre">16</span></code>, <code class="docutils literal notranslate"><span class="pre">32</span></code>, <code class="docutils literal notranslate"><span class="pre">48</span></code>, or <code class="docutils literal notranslate"><span class="pre">64</span></code>. This is the implementation limitation, there are no efficient kernels supported for other leading dimension values.</p></li>
</ul>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h2>
<p><a class="reference internal" href="page_cpu_brgemm_example_cpp.html#doxid-cpu-brgemm-example-cpp"><span class="std std-ref">BRGeMM ukernel example</span></a></p>
<p>This C++ API example demonstrates how to create and execute a BRGeMM ukernel.</p>
<pre class="highlight literal-block"><span></span><span class="cm">/*******************************************************************************</span>
<span class="cm">* Copyright 2024-2025 Intel Corporation</span>
<span class="cm">*</span>
<span class="cm">* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="cm">* you may not use this file except in compliance with the License.</span>
<span class="cm">* You may obtain a copy of the License at</span>
<span class="cm">*</span>
<span class="cm">*     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="cm">*</span>
<span class="cm">* Unless required by applicable law or agreed to in writing, software</span>
<span class="cm">* distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="cm">* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="cm">* See the License for the specific language governing permissions and</span>
<span class="cm">* limitations under the License.</span>
<span class="cm">*******************************************************************************/</span>




<span class="cp">#include</span> <span class="cpf">&lt;algorithm&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;cmath&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;utility&gt;</span>
<span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span>

<span class="cp">#include</span> <span class="cpf">&quot;example_utils.hpp&quot;</span>
<span class="cp">#include</span> <span class="cpf">&quot;oneapi/dnnl/dnnl_ukernel.hpp&quot;</span>

<span class="k">using</span> <span class="k">namespace</span> <a class="reference internal" href="namespace_dnnl.html#doxid-namespacednnl"><span class="std std-ref">dnnl</span></a><span></span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <a class="reference internal" href="namespace_dnnl_ukernel.html#doxid-namespacednnl-1-1ukernel"><span class="std std-ref">dnnl::ukernel</span></a><span></span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">brgemm_example</span><span class="p">()</span> <span class="p">{</span>

    <span class="c1">// Create execution dnnl::engine. Needed for reorders to operate over input</span>
    <span class="c1">// data.</span>
    <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">dnnl::engine</span></a><span></span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">(</span><a class="reference internal" href="enum_dnnl_engine_kind.html#doxid-structdnnl-1-1engine-1a2635da16314dcbdb9bd9ea431316bb1aad9747e2da342bdb995f6389533ad1a3d"><span class="std std-ref">engine::kind::cpu</span></a><span></span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Create dnnl::stream. Needed for reorders for the same reason.</span>
    <a class="reference internal" href="struct_dnnl_stream-2.html#doxid-structdnnl-1-1stream"><span class="std std-ref">dnnl::stream</span></a><span></span> <span class="n">engine_stream</span><span class="p">(</span><a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">);</span>

    <span class="c1">// ukernel dimensions.</span>
    <span class="c1">// K is for a whole tensor, K_blk is for a single ukernel.</span>
    <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">M</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">K_blk</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">48</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">K</span> <span class="o">%</span> <span class="n">K_blk</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;K_blk must divide K.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">n_calls</span> <span class="o">=</span> <span class="n">K</span> <span class="o">/</span> <span class="n">K_blk</span><span class="p">;</span>

    <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dce"><span class="std std-ref">memory::data_type</span></a><span></span> <span class="n">a_dt</span> <span class="o">=</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea077393852be20e37026d6281827662f2"><span class="std std-ref">memory::data_type::u8</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dce"><span class="std std-ref">memory::data_type</span></a><span></span> <span class="n">b_dt</span> <span class="o">=</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea3e8d88fdd85d7153525e0647cdd97686"><span class="std std-ref">memory::data_type::s8</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dce"><span class="std std-ref">memory::data_type</span></a><span></span> <span class="n">c_dt</span> <span class="o">=</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dceaa860868d23f3a68323a2e3f6563d7f31"><span class="std std-ref">memory::data_type::s32</span></a><span></span><span class="p">;</span> <span class="c1">// Accumulator data type.</span>
    <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dce"><span class="std std-ref">memory::data_type</span></a><span></span> <span class="n">d_dt</span> <span class="o">=</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea512dc597be7ae761876315165dc8bd2e"><span class="std std-ref">memory::data_type::f32</span></a><span></span><span class="p">;</span> <span class="c1">// Output data type.</span>

    <span class="c1">// Query the packing requirement from the ukernel. It&#39;s enough to query</span>
    <span class="c1">// packing requirements once for multiple ukernel objects.</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">pack</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1aa2e3310da8dd905e3f7ee81060f1ad19"><span class="std std-ref">brgemm::get_B_pack_type</span></a><span></span><span class="p">(</span><span class="n">a_dt</span><span class="p">,</span> <span class="n">b_dt</span><span class="p">);</span>

    <span class="c1">// If the value is `pack_type::undef`, ukernel API is not supported on the</span>
    <span class="c1">// target system.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">pack</span> <span class="o">==</span> <a class="reference internal" href="enum_dnnl_ukernel_pack_type.html#doxid-group-dnnl-api-ukernel-utils-1gga241c23d0afdf43a79d51ef701a9f7c54af31ee5e3824f1f5e5d206bdf3029f22b"><span class="std std-ref">pack_type::undef</span></a><span></span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Kernel is not supported on this platform.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Packing is required if the returned value is different from</span>
    <span class="c1">// `pack_type::no_pack`.</span>
    <span class="c1">// If packing is required, specific `ldb` value can be used ahead, since</span>
    <span class="c1">// transform has a limited set of supported values.</span>
    <span class="kt">bool</span> <span class="n">need_pack</span> <span class="o">=</span> <span class="n">pack</span> <span class="o">!=</span> <a class="reference internal" href="enum_dnnl_ukernel_pack_type.html#doxid-group-dnnl-api-ukernel-utils-1gga241c23d0afdf43a79d51ef701a9f7c54a76659c0424cb9f2555bc14e7d947db13"><span class="std std-ref">pack_type::no_trans</span></a><span></span><span class="p">;</span>

    <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">lda</span> <span class="o">=</span> <span class="n">K</span><span class="p">;</span>
    <span class="c1">// `ldb` for `need_pack = true` must be one of 16, 32, 48, or 64. This</span>
    <span class="c1">// example doesn&#39;t explore options for dividing N into blocks which would</span>
    <span class="c1">// likely happen for N &gt; 64.</span>
    <span class="c1">// const memory::dim ldb = need_pack ? N_block : N;</span>
    <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">ldb</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span>
    <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">ldc</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span> <span class="c1">// Leading dimension for accumulator.</span>
    <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">ldd</span> <span class="o">=</span> <span class="n">N</span><span class="p">;</span> <span class="c1">// Leading dimension for an actual output.</span>
    <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">batch_size</span> <span class="o">=</span> <span class="n">n_calls</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">// A, B, and C tensors dimensions.</span>
    <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a7d9f4b6ad8caf3969f436cd9ff27e9bb"><span class="std std-ref">memory::dims</span></a><span></span> <span class="n">A_dims</span> <span class="o">=</span> <span class="p">{</span><span class="n">M</span><span class="p">,</span> <span class="n">K</span><span class="p">};</span>
    <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a7d9f4b6ad8caf3969f436cd9ff27e9bb"><span class="std std-ref">memory::dims</span></a><span></span> <span class="n">B_dims</span> <span class="o">=</span> <span class="p">{</span><span class="n">K</span><span class="p">,</span> <span class="n">N</span><span class="p">};</span>
    <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a7d9f4b6ad8caf3969f436cd9ff27e9bb"><span class="std std-ref">memory::dims</span></a><span></span> <span class="n">C_dims</span> <span class="o">=</span> <span class="p">{</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">};</span>
    <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a7d9f4b6ad8caf3969f436cd9ff27e9bb"><span class="std std-ref">memory::dims</span></a><span></span> <span class="n">D_dims</span> <span class="o">=</span> <span class="p">{</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">};</span>
    <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a7d9f4b6ad8caf3969f436cd9ff27e9bb"><span class="std std-ref">memory::dims</span></a><span></span> <span class="n">binary_add_dims</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">};</span>
    <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a7d9f4b6ad8caf3969f436cd9ff27e9bb"><span class="std std-ref">memory::dims</span></a><span></span> <span class="n">B_scales_dims</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">};</span>

    <span class="c1">// Allocate buffers with user data.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">A_user_data</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">A_dims</span><span class="p">));</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">B_user_data</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">B_dims</span><span class="p">));</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">binary_add_user_data</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">binary_add_dims</span><span class="p">));</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">B_scales_user_data</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">B_scales_dims</span><span class="p">));</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">D_data</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">D_dims</span><span class="p">));</span> <span class="c1">// For reference comparison</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">D_user_data</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">D_dims</span><span class="p">));</span> <span class="c1">// For reference comparison</span>

    <span class="c1">// Initialize A.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span><span class="n">A_user_data</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">A_user_data</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[]()</span> <span class="p">{</span>
        <span class="k">static</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">i</span><span class="o">++</span> <span class="o">%</span> <span class="mi">4</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="c1">// Initialize B.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span><span class="n">B_user_data</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">B_user_data</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[]()</span> <span class="p">{</span>
        <span class="k">static</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
        <span class="k">static</span> <span class="kt">int</span> <span class="n">sign_gen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">sign</span> <span class="o">=</span> <span class="p">(</span><span class="n">sign_gen</span><span class="o">++</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
        <span class="kt">float</span> <span class="n">val</span> <span class="o">=</span> <span class="n">sign</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span><span class="o">++</span> <span class="o">%</span> <span class="mi">5</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">val</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="c1">// Initialize binary_add.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span>
            <span class="n">binary_add_user_data</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">binary_add_user_data</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[]()</span> <span class="p">{</span>
                <span class="k">static</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
                <span class="k">return</span> <span class="n">i</span><span class="o">++</span> <span class="o">%</span> <span class="mi">6</span><span class="p">;</span>
            <span class="p">});</span>
    <span class="c1">// Initialize B scales.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span><span class="n">B_scales_user_data</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">B_scales_user_data</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="p">[]()</span> <span class="p">{</span>
        <span class="k">static</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">(</span><span class="kt">float</span><span class="p">)(</span><span class="n">i</span><span class="o">++</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">/</span> <span class="mf">8.f</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="c1">// Create f32 memories. They are used as data holders and reorder into</span>
    <span class="c1">// memories passed to the ukernel.</span>
    <span class="k">auto</span> <span class="n">A_f32_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span>
            <span class="n">A_dims</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea512dc597be7ae761876315165dc8bd2e"><span class="std std-ref">memory::data_type::f32</span></a><span></span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">B_f32_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span>
            <span class="n">B_dims</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea512dc597be7ae761876315165dc8bd2e"><span class="std std-ref">memory::data_type::f32</span></a><span></span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">binary_add_f32_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span>
            <span class="n">binary_add_dims</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea512dc597be7ae761876315165dc8bd2e"><span class="std std-ref">memory::data_type::f32</span></a><span></span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">B_scales_f32_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span>
            <span class="n">B_scales_dims</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea512dc597be7ae761876315165dc8bd2e"><span class="std std-ref">memory::data_type::f32</span></a><span></span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">D_f32_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span>
            <span class="n">D_dims</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea512dc597be7ae761876315165dc8bd2e"><span class="std std-ref">memory::data_type::f32</span></a><span></span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>

    <span class="k">auto</span> <span class="n">A_f32_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">A_f32_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">,</span> <span class="n">A_user_data</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
    <span class="k">auto</span> <span class="n">B_f32_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">B_f32_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">,</span> <span class="n">B_user_data</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
    <span class="k">auto</span> <span class="n">binary_add_f32_mem</span>
            <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">binary_add_f32_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">,</span> <span class="n">binary_add_user_data</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
    <span class="k">auto</span> <span class="n">B_scales_f32_mem</span>
            <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">B_scales_f32_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">,</span> <span class="n">B_scales_user_data</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
    <span class="k">auto</span> <span class="n">D_f32_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">D_f32_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">,</span> <span class="n">D_user_data</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>

    <span class="c1">// Create ukernel memories in requested data types.</span>
    <span class="c1">// Note that all formats are `ab`.</span>
    <span class="k">auto</span> <span class="n">A_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span><span class="n">A_dims</span><span class="p">,</span> <span class="n">a_dt</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">B_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span><span class="n">B_dims</span><span class="p">,</span> <span class="n">b_dt</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">binary_add_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span>
            <span class="n">binary_add_dims</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea512dc597be7ae761876315165dc8bd2e"><span class="std std-ref">memory::data_type::f32</span></a><span></span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">B_scales_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span>
            <span class="n">B_scales_dims</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea512dc597be7ae761876315165dc8bd2e"><span class="std std-ref">memory::data_type::f32</span></a><span></span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">C_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span><span class="n">C_dims</span><span class="p">,</span> <span class="n">c_dt</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">D_md</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory_desc-2.html#doxid-structdnnl-1-1memory-1-1desc"><span class="std std-ref">memory::desc</span></a><span></span><span class="p">(</span><span class="n">D_dims</span><span class="p">,</span> <span class="n">d_dt</span><span class="p">,</span> <a class="reference internal" href="enum_dnnl_memory_format_tag.html#doxid-structdnnl-1-1memory-1a8e71077ed6a5f7fb7b3e6e1a5a2ecf3fa187ef4436122d1cc2f40dc2b92f0eba0"><span class="std std-ref">memory::format_tag::ab</span></a><span></span><span class="p">);</span>

    <span class="k">auto</span> <span class="n">A_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">A_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">B_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">B_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">binary_add_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">binary_add_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">B_scales_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">B_scales_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">C_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">C_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">);</span>
    <span class="k">auto</span> <span class="n">D_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">D_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">);</span>

    <span class="k">const</span> <span class="k">auto</span> <span class="o">*</span><span class="n">A_ptr</span> <span class="o">=</span> <span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">uint8_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">A_mem</span><span class="p">.</span><span class="n">get_data_handle</span><span class="p">());</span>
    <span class="k">auto</span> <span class="o">*</span><span class="n">B_ptr</span> <span class="o">=</span> <span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">uint8_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">B_mem</span><span class="p">.</span><span class="n">get_data_handle</span><span class="p">());</span>

    <span class="k">const</span> <span class="kt">size_t</span> <span class="n">a_dt_size</span>
            <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1ac4064e92cc225fbb6a0431b90004511c"><span class="std std-ref">memory::data_type_size</span></a><span></span><span class="p">(</span><span class="n">A_mem</span><span class="p">.</span><span class="n">get_desc</span><span class="p">().</span><span class="n">get_data_type</span><span class="p">());</span>
    <span class="k">const</span> <span class="kt">size_t</span> <span class="n">b_dt_size</span>
            <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1ac4064e92cc225fbb6a0431b90004511c"><span class="std std-ref">memory::data_type_size</span></a><span></span><span class="p">(</span><span class="n">B_mem</span><span class="p">.</span><span class="n">get_desc</span><span class="p">().</span><span class="n">get_data_type</span><span class="p">());</span>

    <span class="c1">// Reorder user data into buffers passed to ukernels in target data types.</span>
    <a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder"><span class="std std-ref">reorder</span></a><span></span><span class="p">(</span><span class="n">A_f32_mem</span><span class="p">,</span> <span class="n">A_mem</span><span class="p">).</span><a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder-1ab9d5265274a13d4afa1fe33d784a1027"><span class="std std-ref">execute</span></a><span></span><span class="p">(</span><span class="n">engine_stream</span><span class="p">,</span> <span class="n">A_f32_mem</span><span class="p">,</span> <span class="n">A_mem</span><span class="p">);</span>
    <a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder"><span class="std std-ref">reorder</span></a><span></span><span class="p">(</span><span class="n">B_f32_mem</span><span class="p">,</span> <span class="n">B_mem</span><span class="p">).</span><a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder-1ab9d5265274a13d4afa1fe33d784a1027"><span class="std std-ref">execute</span></a><span></span><span class="p">(</span><span class="n">engine_stream</span><span class="p">,</span> <span class="n">B_f32_mem</span><span class="p">,</span> <span class="n">B_mem</span><span class="p">);</span>
    <a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder"><span class="std std-ref">reorder</span></a><span></span><span class="p">(</span><span class="n">binary_add_f32_mem</span><span class="p">,</span> <span class="n">binary_add_mem</span><span class="p">)</span>
            <span class="p">.</span><a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder-1ab9d5265274a13d4afa1fe33d784a1027"><span class="std std-ref">execute</span></a><span></span><span class="p">(</span><span class="n">engine_stream</span><span class="p">,</span> <span class="n">binary_add_f32_mem</span><span class="p">,</span> <span class="n">binary_add_mem</span><span class="p">);</span>
    <a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder"><span class="std std-ref">reorder</span></a><span></span><span class="p">(</span><span class="n">B_scales_f32_mem</span><span class="p">,</span> <span class="n">B_scales_mem</span><span class="p">)</span>
            <span class="p">.</span><a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder-1ab9d5265274a13d4afa1fe33d784a1027"><span class="std std-ref">execute</span></a><span></span><span class="p">(</span><span class="n">engine_stream</span><span class="p">,</span> <span class="n">B_scales_f32_mem</span><span class="p">,</span> <span class="n">B_scales_mem</span><span class="p">);</span>
    <a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder"><span class="std std-ref">reorder</span></a><span></span><span class="p">(</span><span class="n">D_f32_mem</span><span class="p">,</span> <span class="n">D_mem</span><span class="p">).</span><a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder-1ab9d5265274a13d4afa1fe33d784a1027"><span class="std std-ref">execute</span></a><span></span><span class="p">(</span><span class="n">engine_stream</span><span class="p">,</span> <span class="n">D_f32_mem</span><span class="p">,</span> <span class="n">D_mem</span><span class="p">);</span>
    <span class="c1">// Prepare C buffer. Needed to use a single ukernel in the example with</span>
    <span class="c1">// `set_add_C(true)`.</span>
    <span class="c1">// Note: to avoid this step, the first ukernel should run</span>
    <span class="c1">// `set_add_C(false)`, and it will initialize C buffer with intermediate</span>
    <span class="c1">// values.</span>
    <span class="kt">float</span> <span class="o">*</span><span class="n">C_ptr</span> <span class="o">=</span> <span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">float</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">C_mem</span><span class="p">.</span><span class="n">get_data_handle</span><span class="p">());</span>
    <span class="k">for</span> <span class="p">(</span><a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">M</span> <span class="o">*</span> <span class="n">N</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">C_ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Create ukernel post-ops (ReLU + Add).</span>
    <span class="c1">// It reuses `primitive_attr` abstraction.</span>
    <a class="reference internal" href="struct_dnnl_post_ops-2.html#doxid-structdnnl-1-1post-ops"><span class="std std-ref">post_ops</span></a><span></span> <span class="n">brgemm_ops</span><span class="p">;</span>
    <span class="n">brgemm_ops</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_post_ops-2.html#doxid-structdnnl-1-1post-ops-1a60ce0e18ec1ef06006e7d72e7aa865be"><span class="std std-ref">append_eltwise</span></a><span></span><span class="p">(</span>
            <a class="reference internal" href="enum_dnnl_algorithm.html#doxid-group-dnnl-api-attributes-1gga00377dd4982333e42e8ae1d09a309640aba09bebb742494255b90b43871c01c69"><span class="std std-ref">algorithm::eltwise_relu</span></a><span></span><span class="p">,</span> <span class="cm">/* alpha = */</span> <span class="mf">0.f</span><span class="p">,</span> <span class="cm">/* beta = */</span> <span class="mf">0.f</span><span class="p">);</span>
    <span class="n">brgemm_ops</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_post_ops-2.html#doxid-structdnnl-1-1post-ops-1a40bb2b39a685726ac54873b203be41b5"><span class="std std-ref">append_binary</span></a><span></span><span class="p">(</span><a class="reference internal" href="enum_dnnl_algorithm.html#doxid-group-dnnl-api-attributes-1gga00377dd4982333e42e8ae1d09a309640ab2c3faf084cf82b5603946995f637b35"><span class="std std-ref">algorithm::binary_add</span></a><span></span><span class="p">,</span> <span class="n">binary_add_md</span><span class="p">);</span>

    <span class="c1">// Create BRGeMM ukernel objects.</span>
    <span class="c1">// There are two objects:</span>
    <span class="c1">// * `brg` is the basic one which operates over K dimension divided into</span>
    <span class="c1">//   blocks. It utilizes `set_add_C(true)` to accumulate into the same</span>
    <span class="c1">//   buffer. It also uses `batch_size` to process as much as the number of</span>
    <span class="c1">//   blocks over K minus one.</span>
    <span class="c1">// * `brg_po` is the ukernel that would be called the last in the chain</span>
    <span class="c1">//   since it has attributes attached to the object and those will execute</span>
    <span class="c1">//   after all accumulation over K dimension is done.</span>
    <a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm"><span class="std std-ref">brgemm</span></a><span></span> <span class="n">brg</span><span class="p">,</span> <span class="n">brg_po</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">batch_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Construct a basic brgemm object.</span>
        <span class="c1">// `allow_empty` makes the interface to return an empty `brg` object</span>
        <span class="c1">// in case of the critical error.</span>
        <span class="n">brg</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm"><span class="std std-ref">brgemm</span></a><span></span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">K_blk</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">lda</span><span class="p">,</span> <span class="n">ldb</span><span class="p">,</span> <span class="n">ldc</span><span class="p">,</span> <span class="n">a_dt</span><span class="p">,</span> <span class="n">b_dt</span><span class="p">,</span> <span class="n">c_dt</span><span class="p">,</span>
                <span class="cm">/* allow_empty = */</span> <span class="nb">true</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">brg</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Error: brg object was not constructed.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Instruct the ukernel to append the result to the C tensor.</span>
        <span class="n">brg</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a4546a4aad9b1e3769ce1b5c51b7f746c"><span class="std std-ref">set_add_C</span></a><span></span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>

        <span class="c1">// Finalize the initialization.</span>
        <span class="c1">// Successful completion returns `true`. Otherwise, `brg` object can&#39;t</span>
        <span class="c1">// be used due to lack of support or non-compatible settings. The</span>
        <span class="c1">// specific reason may be found by using `ONEDNN_VERBOSE=all` env var.</span>
        <span class="k">const</span> <span class="kt">bool</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">brg</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a5e42fe0936faab76c675edb97860de0e"><span class="std std-ref">finalize</span></a><span></span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ok</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Kernel is not supported on this platform.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Generate the executable code.</span>
        <span class="n">brg</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1ae7c33dba7d829ced8d6b2de161159f69"><span class="std std-ref">generate</span></a><span></span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Construct a brgemm object with post-ops.</span>
    <span class="n">brg_po</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm"><span class="std std-ref">brgemm</span></a><span></span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">K_blk</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lda</span><span class="p">,</span> <span class="n">ldb</span><span class="p">,</span> <span class="n">ldc</span><span class="p">,</span> <span class="n">a_dt</span><span class="p">,</span> <span class="n">b_dt</span><span class="p">,</span> <span class="n">c_dt</span><span class="p">,</span>
            <span class="cm">/* allow_empty = */</span> <span class="nb">true</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">brg_po</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Error: brg_po object was not constructed.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Instruct the kernel to append the result to the C tensor computed by</span>
    <span class="c1">// `brg` ukernel.</span>
    <span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a4546a4aad9b1e3769ce1b5c51b7f746c"><span class="std std-ref">set_add_C</span></a><span></span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="c1">// Specify post-ops.</span>
    <span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a99c44446d24cb50e8c1c20c11c4d7e4e"><span class="std std-ref">set_post_ops</span></a><span></span><span class="p">(</span><span class="n">ldd</span><span class="p">,</span> <span class="n">d_dt</span><span class="p">,</span> <span class="n">brgemm_ops</span><span class="p">);</span>
    <span class="c1">// Specify quantization scales for B.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">b_dt</span> <span class="o">==</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea3e8d88fdd85d7153525e0647cdd97686"><span class="std std-ref">memory::data_type::s8</span></a><span></span> <span class="o">||</span> <span class="n">b_dt</span> <span class="o">==</span> <a class="reference internal" href="enum_dnnl_memory_data_type.html#doxid-structdnnl-1-1memory-1a8e83474ec3a50e08e37af76c8c075dcea077393852be20e37026d6281827662f2"><span class="std std-ref">memory::data_type::u8</span></a><span></span><span class="p">)</span> <span class="p">{</span>
        <span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a0b17ef5afc621818865d6e41dba66ccc"><span class="std std-ref">set_B_scales</span></a><span></span><span class="p">(</span><span class="cm">/* mask = */</span> <span class="mi">2</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Finalize the initialization.</span>
    <span class="k">const</span> <span class="kt">bool</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a5e42fe0936faab76c675edb97860de0e"><span class="std std-ref">finalize</span></a><span></span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ok</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Kernel is not supported on this platform.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Generate the executable code.</span>
    <span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1ae7c33dba7d829ced8d6b2de161159f69"><span class="std std-ref">generate</span></a><span></span><span class="p">();</span>

    <span class="c1">// Query a scratchpad size and initialize a scratchpad buffer if the ukernel</span>
    <span class="c1">// is expecting it. This is a service space needed, has nothing in common</span>
    <span class="c1">// with accumulation buffer.</span>
    <span class="kt">size_t</span> <span class="n">scratchpad_size</span> <span class="o">=</span> <span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1ada0b6984b8b9253cba9756c680c07d16"><span class="std std-ref">get_scratchpad_size</span></a><span></span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">uint8_t</span><span class="o">&gt;</span> <span class="n">scratchpad</span><span class="p">(</span><span class="n">scratchpad_size</span><span class="p">);</span>

    <span class="kt">uint8_t</span> <span class="o">*</span><span class="n">B_blocked</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
    <span class="kt">void</span> <span class="o">*</span><span class="n">B_base_ptr</span> <span class="o">=</span> <span class="n">B_ptr</span><span class="p">;</span>
    <span class="kt">size_t</span> <span class="n">blocked_B_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">// If packing is needed, create a dedicated object for data transformation.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">need_pack</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Transform kernel for tensor B. The ukernel expects B passed in a</span>
        <span class="c1">// special VNNI format for low precision data types, e.g., bfloat16_t</span>
        <span class="c1">// or int8.</span>
        <span class="c1">// Note: the routine doesn&#39;t provide a `batch_size` argument in the</span>
        <span class="c1">// constructor as it can be either incorporated into `K` dimension, or</span>
        <span class="c1">// manually iterated over in a for-loop on the user side.</span>
        <a class="reference internal" href="struct_dnnl_ukernel_transform.html#doxid-structdnnl-1-1ukernel-1-1transform"><span class="std std-ref">transform</span></a><span></span> <span class="n">pack_B</span><span class="p">(</span><span class="cm">/* K = */</span> <span class="n">K_blk</span> <span class="o">*</span> <span class="n">n_calls</span><span class="p">,</span> <span class="cm">/* N = */</span> <span class="n">N</span><span class="p">,</span>
                <span class="cm">/* in_pack_type = */</span> <a class="reference internal" href="enum_dnnl_ukernel_pack_type.html#doxid-group-dnnl-api-ukernel-utils-1gga241c23d0afdf43a79d51ef701a9f7c54a76659c0424cb9f2555bc14e7d947db13"><span class="std std-ref">pack_type::no_trans</span></a><span></span><span class="p">,</span> <span class="cm">/* in_ld = */</span> <span class="n">N</span><span class="p">,</span>
                <span class="cm">/* out_ld = */</span> <span class="n">ldb</span><span class="p">,</span> <span class="cm">/* in_dt = */</span> <span class="n">b_dt</span><span class="p">,</span> <span class="cm">/* out_dt = */</span> <span class="n">b_dt</span><span class="p">);</span>

        <span class="c1">// Size of the packed tensor.</span>
        <span class="n">blocked_B_size</span> <span class="o">=</span> <span class="n">ldb</span> <span class="o">*</span> <span class="n">K_blk</span> <span class="o">*</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1ac4064e92cc225fbb6a0431b90004511c"><span class="std std-ref">memory::data_type_size</span></a><span></span><span class="p">(</span><span class="n">b_dt</span><span class="p">);</span>

        <span class="n">B_blocked</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">uint8_t</span><span class="p">[</span><span class="n">blocked_B_size</span> <span class="o">*</span> <span class="n">n_calls</span><span class="p">];</span>
        <span class="n">B_base_ptr</span> <span class="o">=</span> <span class="n">B_blocked</span><span class="p">;</span>

        <span class="c1">// Generate the executable code.</span>
        <span class="n">pack_B</span><span class="p">.</span><span class="n">generate</span><span class="p">();</span>

        <span class="c1">// Pack B routine execution.</span>
        <span class="c1">// Note: usually should be split to process only a part of B that the</span>
        <span class="c1">// ukernel will execute.</span>
        <span class="n">pack_B</span><span class="p">.</span><span class="n">execute</span><span class="p">(</span><span class="n">B_ptr</span><span class="p">,</span> <span class="n">B_blocked</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// ukernel execution section.</span>
    <span class="c1">//</span>
    <span class="c1">// Prepare buffers for execution.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">memory</span><span class="o">::</span><span class="n">dim</span><span class="p">,</span> <span class="n">memory</span><span class="o">::</span><span class="n">dim</span><span class="o">&gt;&gt;</span> <span class="n">A_B_offsets</span><span class="p">(</span><span class="n">batch_size</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">batch_size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">A_offset_i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">K_blk</span> <span class="o">*</span> <span class="n">a_dt_size</span><span class="p">;</span>
        <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">B_offset_i</span>
                <span class="o">=</span> <span class="n">need_pack</span> <span class="o">?</span> <span class="n">i</span> <span class="o">*</span> <span class="nl">blocked_B_size</span> <span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="n">K_blk</span> <span class="o">*</span> <span class="n">b_dt_size</span><span class="p">;</span>
        <span class="n">A_B_offsets</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">make_pair</span><span class="p">(</span><span class="n">A_offset_i</span><span class="p">,</span> <span class="n">B_offset_i</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">brg</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// A call to initialize hardware features. For example, prepare AMX</span>
        <span class="c1">// unit.</span>
        <span class="n">brg</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1ac273853c939803d7c0f20fe1b8c41f48"><span class="std std-ref">set_hw_context</span></a><span></span><span class="p">();</span>

        <span class="c1">// An execute call. `A_B_offsets` is a vector of pairs of offsets to A</span>
        <span class="c1">// and packed B tensors. `C_ptr` is a pointer to an accumulator buffer.</span>
        <span class="n">brg</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a89e2b117573de5ac4be161c7294af55b"><span class="std std-ref">execute</span></a><span></span><span class="p">(</span><span class="n">A_ptr</span><span class="p">,</span> <span class="n">B_base_ptr</span><span class="p">,</span> <span class="n">A_B_offsets</span><span class="p">,</span> <span class="n">C_ptr</span><span class="p">,</span> <span class="n">scratchpad</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="c1">// Same set of operations for a ukernel with post-ops.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="n">memory</span><span class="o">::</span><span class="n">dim</span><span class="p">,</span> <span class="n">memory</span><span class="o">::</span><span class="n">dim</span><span class="o">&gt;&gt;</span> <span class="n">A_B_po_offsets</span><span class="p">;</span>
    <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">A_offset_po</span> <span class="o">=</span> <span class="n">batch_size</span> <span class="o">*</span> <span class="n">K_blk</span> <span class="o">*</span> <span class="n">a_dt_size</span><span class="p">;</span>
    <span class="k">const</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory-1a281426f169daa042dcf5379c8fce21a9"><span class="std std-ref">memory::dim</span></a><span></span> <span class="n">B_offset_po</span> <span class="o">=</span> <span class="n">need_pack</span>
            <span class="o">?</span> <span class="n">batch_size</span> <span class="o">*</span> <span class="nl">blocked_B_size</span>
            <span class="p">:</span> <span class="n">batch_size</span> <span class="o">*</span> <span class="n">N</span> <span class="o">*</span> <span class="n">K_blk</span> <span class="o">*</span> <span class="n">b_dt_size</span><span class="p">;</span>
    <span class="n">A_B_po_offsets</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">A_offset_po</span><span class="p">,</span> <span class="n">B_offset_po</span><span class="p">);</span>

    <span class="c1">// This object also requires this call since ukernel with post-ops may</span>
    <span class="c1">// require differently initialized internals underneath. If basic ukernel</span>
    <span class="c1">// was used and they share the same internals, this call will be optimized.</span>
    <span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1ac273853c939803d7c0f20fe1b8c41f48"><span class="std std-ref">set_hw_context</span></a><span></span><span class="p">();</span>

    <span class="c1">// Prepare post-ops arguments and put them in a vector to make sure pointers</span>
    <span class="c1">// are sitting side by side.</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="k">const</span> <span class="kt">void</span> <span class="o">*&gt;</span> <span class="n">bin_po_ptrs</span><span class="p">;</span>
    <span class="n">bin_po_ptrs</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">binary_add_mem</span><span class="p">.</span><span class="n">get_data_handle</span><span class="p">());</span>

    <span class="c1">// Setting post-ops arguments into an attributes arguments storage.</span>
    <a class="reference internal" href="struct_dnnl_ukernel_attr_params-2.html#doxid-structdnnl-1-1ukernel-1-1attr-params"><span class="std std-ref">attr_params</span></a><span></span> <span class="n">params</span><span class="p">;</span>
    <span class="n">params</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_attr_params-2.html#doxid-structdnnl-1-1ukernel-1-1attr-params-1af991f15932b7c0fef737cdc61dd56de0"><span class="std std-ref">set_post_ops_args</span></a><span></span><span class="p">(</span><span class="n">bin_po_ptrs</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
    <span class="n">params</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_attr_params-2.html#doxid-structdnnl-1-1ukernel-1-1attr-params-1a9e2c17ea304a349479bc36124b08e200"><span class="std std-ref">set_B_scales</span></a><span></span><span class="p">(</span><span class="n">B_scales_mem</span><span class="p">.</span><span class="n">get_data_handle</span><span class="p">());</span>

    <span class="c1">// An execute call. The difference here is when post operations are</span>
    <span class="c1">// requested, an additional D tensor pointer to store final output result</span>
    <span class="c1">// after finishing accumulation and post-ops application is required.</span>
    <span class="c1">// Additionally, a special `params` object with post operations handles</span>
    <span class="c1">// is required.</span>
    <span class="c1">//</span>
    <span class="c1">// If post operations are not defined, the call is invalid, and a special</span>
    <span class="c1">// API checks its validity.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a2636a460ecb30c8c9535d8c18858c1ef"><span class="std std-ref">is_execute_postops_valid</span></a><span></span><span class="p">())</span> <span class="p">{</span>
        <span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a89e2b117573de5ac4be161c7294af55b"><span class="std std-ref">execute</span></a><span></span><span class="p">(</span><span class="n">A_ptr</span><span class="p">,</span> <span class="n">B_base_ptr</span><span class="p">,</span> <span class="n">A_B_po_offsets</span><span class="p">,</span> <span class="n">C_ptr</span><span class="p">,</span>
                <span class="n">D_mem</span><span class="p">.</span><span class="n">get_data_handle</span><span class="p">(),</span> <span class="n">scratchpad</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">params</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">brg_po</span><span class="p">.</span><a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a89e2b117573de5ac4be161c7294af55b"><span class="std std-ref">execute</span></a><span></span><span class="p">(</span>
                <span class="n">A_ptr</span><span class="p">,</span> <span class="n">B_base_ptr</span><span class="p">,</span> <span class="n">A_B_po_offsets</span><span class="p">,</span> <span class="n">C_ptr</span><span class="p">,</span> <span class="n">scratchpad</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="c1">// Once all computations are done and there are no more calls to ukernels</span>
    <span class="c1">// until they delegate control to the application, need to release the</span>
    <span class="c1">// hardware context.</span>
    <a class="reference internal" href="struct_dnnl_ukernel_brgemm.html#doxid-structdnnl-1-1ukernel-1-1brgemm-1a4cdc1e8b77991a2da8a69ae5f4ce267a"><span class="std std-ref">brgemm::release_hw_context</span></a><span></span><span class="p">();</span>

    <span class="c1">// Clean up an extra buffer.</span>
    <span class="k">delete</span> <span class="n">B_blocked</span><span class="p">;</span>

    <span class="c1">// Used for verification results, need unconditional reorder.</span>
    <span class="k">auto</span> <span class="n">user_D_mem</span> <span class="o">=</span> <a class="reference internal" href="struct_dnnl_memory-2.html#doxid-structdnnl-1-1memory"><span class="std std-ref">memory</span></a><span></span><span class="p">(</span><span class="n">D_f32_md</span><span class="p">,</span> <a class="reference internal" href="struct_dnnl_engine-2.html#doxid-structdnnl-1-1engine"><span class="std std-ref">engine</span></a><span></span><span class="p">,</span> <span class="n">D_data</span><span class="p">.</span><span class="n">data</span><span class="p">());</span>
    <a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder"><span class="std std-ref">reorder</span></a><span></span><span class="p">(</span><span class="n">D_mem</span><span class="p">,</span> <span class="n">user_D_mem</span><span class="p">).</span><a class="reference internal" href="struct_dnnl_reorder.html#doxid-structdnnl-1-1reorder-1ab9d5265274a13d4afa1fe33d784a1027"><span class="std std-ref">execute</span></a><span></span><span class="p">(</span><span class="n">engine_stream</span><span class="p">,</span> <span class="n">D_mem</span><span class="p">,</span> <span class="n">user_D_mem</span><span class="p">);</span>

    <span class="c1">// Skip the check by default as data filling doesn&#39;t help with proper</span>
    <span class="c1">// verification of the result. Negative result doesn&#39;t necessarily mean</span>
    <span class="c1">// the functionality is broken. This is just a general sanity check.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="c1">// A simplified fast verification that ukernel returned expected results.</span>
    <span class="c1">// Note: potential off-by-1 or 2 errors may pop up. This could be solved</span>
    <span class="c1">// with more sparse filling.</span>
    <span class="kt">bool</span> <span class="n">to_throw</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">m</span> <span class="o">&lt;</span> <span class="n">M</span><span class="p">;</span> <span class="n">m</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">;</span> <span class="n">n</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">D_user_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">K</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">D_user_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span>
                        <span class="o">+=</span> <span class="n">A_user_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">K</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">B_user_data</span><span class="p">[</span><span class="n">k</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">];</span>
            <span class="p">}</span>
            <span class="c1">// B scales ref</span>
            <span class="n">D_user_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span> <span class="o">*=</span> <span class="n">B_scales_user_data</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
            <span class="c1">// Relu post-op ref</span>
            <span class="n">D_user_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">max</span><span class="p">(</span><span class="n">D_user_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">],</span> <span class="mf">0.f</span><span class="p">);</span>
            <span class="c1">// Binary post-op ref</span>
            <span class="n">D_user_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span> <span class="o">+=</span> <span class="n">binary_add_user_data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

            <span class="k">const</span> <span class="kt">float</span> <span class="n">diff</span>
                    <span class="o">=</span> <span class="n">fabsf</span><span class="p">(</span><span class="n">D_user_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">D_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">]);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">diff</span> <span class="o">&gt;</span> <span class="mf">1.19e-7</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">to_throw</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Error: [%3d:%3d] Ref:%12g Got:%12g Diff:%12g</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span>
                            <span class="n">n</span><span class="p">,</span> <span class="n">D_user_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">],</span> <span class="n">D_data</span><span class="p">[</span><span class="n">m</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">n</span><span class="p">],</span> <span class="n">diff</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">to_throw</span><span class="p">)</span> <span class="p">{</span> <span class="k">throw</span> <a class="reference internal" href="enum_dnnl_status.html#doxid-group-dnnl-api-service-1gga7acc4d3516304ae68a1289551d8f2cdda5b32065884bcc1f2ed126c47e6410808"><span class="std std-ref">status::runtime_error</span></a><span></span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">handle_example_errors</span><span class="p">({</span><a class="reference internal" href="enum_dnnl_engine_kind.html#doxid-structdnnl-1-1engine-1a2635da16314dcbdb9bd9ea431316bb1aad9747e2da342bdb995f6389533ad1a3d"><span class="std std-ref">dnnl::engine::kind::cpu</span></a><span></span><span class="p">},</span> <span class="n">brgemm_example</span><span class="p">);</span>
<span class="p">}</span></pre>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="dev_guide_ukernel_brgemm.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Batch-Reduce General Matrix Multiplication</p>
      </div>
    </a>
    <a class="right-next"
       href="page_cpu_brgemm_example_cpp.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">BRGeMM ukernel example</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general">General</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-types">Data Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-representation">Data Representation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-limitations">Implementation limitations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2016-2025 Intel Corporation.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  oneDNN is licensed under Apache License Version 2.0. Refer to the <a href='https://github.com/uxlfoundation/oneDNN/blob/main/LICENSE'>LICENSE</a> file for the full license text and copyright notice.
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>